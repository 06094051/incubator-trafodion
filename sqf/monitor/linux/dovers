#!/bin/sh

TMP=/tmp/ver$$
DATE=`date +%d%h%Y|sed y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/`
QA_DATE=26OCT2009
VERSION=0_12_0

trap "rm -f ${TMP}*; exit 1" 1 2 15
trap "rm -f ${TMP}*; exit 0" 1 2 13


if [ $# -ne 2 ]
then
    echo "Usage: $0 inversfile outversfile"
    exit 1
fi

if [ -r $1 ]
then
sed s/%DDMMMYYYY%/$DATE/g $1 | sed s/%QA_DATE%/$QA_DATE/g | sed s/%VERSION%/$VERSION/g > ${TMP}1
    if [ $? -ne 0 ]
    then
        echo "couldn\'t sed $1"
    else
        if [ -r $1 ]
        then
            cmp -s ${TMP}1 $2
            if [ $? -ne 0 ]
            then
                rm -f $2
                cp -p ${TMP}1 $2
            fi
        else
            cp -p ${TMP}1 $2
        fi
    fi
else
    echo "couldn't find $1"
    exit 1
fi

rm -f ${TMP}*
exit 0

